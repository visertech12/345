import{g as e,a as t,be as s,v as o,t as i,w as a,x as l,D as n,y as c,z as r,E as h,u as d,bf as u,bg as p,b as f,b8 as m,b9 as y,i as g,f as v,l as _,q as b,B as $,F as x,A as C,H as w,G as k,b5 as I}from"./index-DJtkXLbk.js";import{_ as V}from"./fui-icon.Di2eQoC1.js";import{r as B}from"./uni-app.es.DnKBEGT2.js";import{_ as P}from"./fui-nav-bar.jzMwm7nO.js";import{_ as j}from"./fui-button.Bz1nWTaC.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as T}from"./uni-popup.CzvQehha.js";import{_ as R}from"./authPop.J76QaGfj.js";import{_ as z}from"./areacode.D1oZi0ud.js";import{_ as E}from"./alert.Dea_H56C.js";import{u as D}from"./user.Bg4aheva.js";import"./uni-popup-dialog.BcHbARwi.js";const F=S({props:{disabled:{type:Boolean,default:!1},offset:{type:Number,default:3},dBgColor:{type:String,default:"#f8f9f9"},sBgColor:{type:String,default:"#3070ec"},dColor:{type:String,default:"#b9bdc2"},sColor:{type:String,default:"#60b485"}},data(){return{x:0,oldx:.1,success:!1,verification:0,isDisable:this.disabled,screenWidth:0}},mounted(){const t=e();this.screenWidth=t.screenWidth},computed:{...t(["userTheme"])},methods:{onMove(e){this.oldx=e.detail.x},touchend(){if(!(this.success||this.oldx<1&&.1!=this.oldx)){this.x=this.oldx;var e=0,t=0;s().in(this).select(".slider-prompt").boundingClientRect((o=>{o.width>0&&(e=o.width,s().in(this).select(".movable-btn").boundingClientRect((s=>{s.width>0&&(t=s.width,.1!=this.oldx&&this.verification++,this.oldx>e-t-this.offset?(this.success=!0,this.isDisable=!0,this.verificationSuccess(!0)):(this.$nextTick((()=>{this.x=0,this.oldx=0})),this.verificationSuccess(!1)))})).exec())})).exec()}},verificationSuccess(e){let t={state:e,verification:this.verification};this.$emit("change",t)},initialization(){this.x=0,this.oldx=.1,this.verification=0,this.success=!1,this.isDisable=!1,this.touchend()}}},[["render",function(e,t,s,f,m,y){const g=d,v=u,_=p;return o(),i(g,{class:"slider-verify","data-theme":e.userTheme,style:n("background-color:"+s.dBgColor),onTouchend:y.touchend},{default:a((()=>[l(g,{class:"slider-wrap",style:n("background-color:"+s.sBgColor)},{default:a((()=>[l(g,{class:"slider-prompt font-13 font-weight",style:n(m.success?"color:"+s.sColor:"color:"+s.dColor)},{default:a((()=>[c(r(m.success?e.$t("common.slider_result"):e.$t("common.slider_text")),1)])),_:1},8,["style"]),l(g,{class:"slider-bg",style:n({transform:"translateX("+m.oldx+"px)",backgroundColor:s.dBgColor})},null,8,["style"]),l(_,{class:"slider-area",animation:!0},{default:a((()=>[l(v,{style:n({borderColor:m.success?s.sBgColor:s.dBgColor}),class:h({"movable-btn":!0,"movable-success":m.success}),x:m.x,direction:"horizontal",onChange:y.onMove,disabled:m.isDisable},null,8,["style","class","x","onChange","disabled"])])),_:1})])),_:1},8,["style"])])),_:1},8,["data-theme","style","onTouchend"])}],["__scopeId","data-v-ee8e2a0e"]]);var L,W=!1,A=!1;const N=S({data(){return{active:0,showareacode:"+01",code:"",onFocus:!1,first:!0,type:"",account:"",vcode:"",txt:this.$t("secrety.get_code"),ctxt:this.$t("login.cancel"),ftxt:this.$t("login.confirm"),title:this.$t("login.tip_t2"),content:"",poptitle:"",lang:""}},onLoad(e){this.first=parseInt(e.new),this.type=e.type,"email"==this.type&&(this.active=1)},onShow(){this.getLang()},computed:{...t(["userTheme"])},methods:{...f(["updateInfo"]),subResult(){200==L&&(L=0,this.$mroute.back())},resend(){A=!0,this.submitVerify()},async submit(e){if(this.$refs.authPop.close(),1!=this.first){if(m({title:this.$t("secrety.processing")}),console.log(e),"email"==this.type&&(t=await D.submitBindEmail({email:this.account,email_vcode:this.vcode,vcode:e})),"phone"==this.type&&(t=await D.submitBindPhone({code:this.showareacode,phone:this.account,vcode:this.vcode,email_vcode:e})),console.log(t),y(),200!=t.code)return this.content=t.message,this.$refs.alert.open(),!1;"email"==this.type&&this.updateInfo("email",this.account),"phone"==this.type&&this.updateInfo("phone",this.account),this.content=("email"==this.type?this.$t("login.email"):this.$t("login.phone"))+this.$t("secrety.bind_suc"),this.$refs.alert.open(),L=200}else{var t;if(m({title:this.$t("secrety.processing")}),t="email"==this.type?await D.submitChangeEmail({email:this.account,new_code:this.vcode,vcode:e}):await D.submitChangePhone({phone:this.account,area:this.$util.replaceEmpty(this.showareacode),new_code:this.vcode,code:e}),y(),200!=t.code)return this.content=t.message,this.$refs.alert.open(),!1;"email"==this.type&&this.updateInfo("email",this.account),"phone"==this.type&&this.updateInfo("phone",this.account),this.content=this.$t("secrety.mod_suc"),this.$refs.alert.open(),L=200}},async submitVerify(){return!(this.account.length<5||!W)&&(m({title:this.$t("login.send")}),"email"==this.type&&0==this.first&&(e=await D.sendPhoneCode(),this.poptitle=this.$t("secrety.phone_code")),"phone"==this.type&&0==this.first&&(e=await D.sendEmailCode(),this.poptitle=this.$t("secrety.email_code")),"email"==this.type&&1==this.first&&(e=await D.sendEmailCode(),this.poptitle=this.$t("secrety.email_code")),"phone"==this.type&&1==this.first&&(e=await D.sendPhoneCode(),this.poptitle=this.$t("secrety.phone_code")),y(),console.log(e),200!=e.code?(this.content=e.message,this.$refs.alert.open(),!1):void(A||this.$refs.authPop.open()));var e},sendCode(){if(this.account.length<5)return this.content=this.$t("secrety.account_info"),this.$refs.alert.open(),!1;m({title:this.$t("login.send")}),"email"==this.type&&g.sendEmailVerifyCode(this.account).then((e=>{if(y(),200!=e.code)return this.content=e.message,this.$refs.alert.open(),!1;v({title:this.$t("secrety.send_to")+":"+this.account,duration:2e3}),W=!0})).catch((e=>{y(),v({title:this.$t("secrety.fail_send"),icon:"none"})})),"email"!=this.type&&g.sendPhoneVerifyCode(this.account,this.showareacode).then((e=>{if(y(),200!=e.code)return this.content=e.message,this.$refs.alert.open(),!1;v({title:this.$t("secrety.send_to")+":"+this.account,duration:2e3}),W=!0})).catch((e=>{y(),v({title:this.$t("secrety.fail_send"),icon:"none"})}))},initTime(){var e=300,t=setInterval((()=>{this.txt=e+"s",--e<=1&&(clearInterval(t),this.txt=this.$t("secrety.get_code"))}),1e3)},verifyResult(e){console.log(e),e.state&&(this.$refs.verifypop.close(),console.log(L),1==L&&this.sendCode())},robotVerify(){if(this.account.length<5)return this.content=this.$t("secrety.account_info"),this.$refs.alert.open(),!1;this.$refs.verifypop.open(),L=1},areaSelect(e){this.showareacode=e.dialingCode},inputCode(e){this.code=e.detail.value},open(){this.$refs.areacode.open()},verifyopen(){this.$refs.verifypop.open()},authPopopen(){this.$refs.authPop.open()},getLang(){this.lang=_("lang"),console.log(this.lang)}}},[["render",function(e,t,s,h,u,p){const f=B(b("fui-icon"),V),m=B(b("fui-nav-bar"),P),y=w,g=k,v=d,_=I,S=B(b("fui-button"),j),D=B(b("liu-slider-verify"),F),L=B(b("uni-popup"),T),W=B(b("authPop"),R),A=B(b("areacode"),z),N=B(b("alert"),E);return o(),$(x,null,[l(v,{class:"phoneAuth","data-theme":e.userTheme},{default:a((()=>[l(m,{statusBar:"",isFixed:"",isOccupy:"",zIndex:"9",background:"var(--background-primary)",color:"var(--content-primary)",title:(1==u.first?this.$t("secrety.revise"):this.$t("secrety.bind_t"))+("zh_CN"!=u.lang?" ":"")+("phone"==u.type?this.$t("secrety.phone_ver"):this.$t("secrety.email_ver")),onLeftClick:t[0]||(t[0]=t=>e.$mroute.back())},{default:a((()=>[l(f,{name:"arrowleft",size:"56",color:"var(--content-primary)"})])),_:1},8,["title"]),l(v,{class:"phoneAuth-container"},{default:a((()=>[l(v,{class:"label"},{default:a((()=>[l(y,{class:"font-13 color-gray"},{default:a((()=>[c(r(0==u.active?1==u.first?this.$t("login.phone1"):this.$t("secrety.new_phone"):1==u.first?this.$t("login.email1"):this.$t("secrety.new_email")),1)])),_:1}),0==u.active?(o(),i(v,{key:0,class:"label-input",type:"phone"},{default:a((()=>[l(v,{class:"code-box",onClick:p.open},{default:a((()=>[l(y,{class:"font-14 color-black"},{default:a((()=>[c(r(u.showareacode),1)])),_:1}),l(g,{src:`/static/img/tactic/down-${e.userTheme}.png`,mode:"widthFix"},null,8,["src"])])),_:1},8,["onClick"]),l(_,{type:"text",modelValue:u.account,"onUpdate:modelValue":t[1]||(t[1]=e=>u.account=e),class:"font-14 color-black",placeholder:this.$t("login.phone_p"),"placeholder-class":"placeholder"},null,8,["modelValue","placeholder"])])),_:1})):C("",!0),1==u.active?(o(),i(v,{key:1,class:"label-input"},{default:a((()=>[l(_,{type:"text",modelValue:u.account,"onUpdate:modelValue":t[2]||(t[2]=e=>u.account=e),class:"font-14 color-black",placeholder:this.$t("login.email_p"),"placeholder-class":"placeholder"},null,8,["modelValue","placeholder"])])),_:1})):C("",!0)])),_:1}),l(v,{class:"label"},{default:a((()=>[l(y,{class:"font-13 color-gray"},{default:a((()=>[c(r(0==u.active?this.$t("secrety.phone_code"):this.$t("secrety.email_code")),1)])),_:1}),l(v,{class:"label-input",type:"captcha"},{default:a((()=>[l(_,{type:"text",modelValue:u.vcode,"onUpdate:modelValue":t[3]||(t[3]=e=>u.vcode=e),onInput:p.inputCode,class:"font-14 color-black",placeholder:this.$t("authPop.enter_code"),"placeholder-class":"placeholder"},null,8,["modelValue","onInput","placeholder"]),l(v,{class:"captcha"},{default:a((()=>[l(y,{class:"font-13 color-primary",onClick:t[4]||(t[4]=e=>p.robotVerify())},{default:a((()=>[c(r(u.txt),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(v,{class:"footer-button"},{default:a((()=>[l(S,{height:"78rpx",background:u.code.length>=4?"var(--color-primary)":"var(--background-secondary)",color:u.code.length>=4?"var(--content-always-white)":"var(--content-tertiary)",size:"28",radius:"78rpx",text:e.$t("secrety.submit"),onClick:t[5]||(t[5]=e=>p.submitVerify())},null,8,["background","color","text"])])),_:1})])),_:1},8,["data-theme"]),l(L,{"data-theme":e.userTheme,ref:"verifypop",style:n({width:e.$device.screenWidth+"px"}),type:"center"},{default:a((()=>[l(v,{class:"swipe-verify"},{default:a((()=>[l(v,{class:"swipe-verify-cell"},{default:a((()=>[l(y,{class:"font-16 color-black font-weight"},{default:a((()=>[c(r(e.$t("login.verify_t1")),1)])),_:1})])),_:1}),l(v,{class:"swipe-verify-content"},{default:a((()=>[l(D,{style:{width:"570rpx"},dBgColor:"var(--background-secondary)",ref:"verify",onChange:p.verifyResult},null,8,["onChange"])])),_:1}),l(v,{class:"swipe-verify-cell"},{default:a((()=>[l(y,{class:"font-12 color-gray"},{default:a((()=>[c(r(e.$t("login.verify_t2")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["data-theme","style"]),l(W,{ref:"authPop",title:u.poptitle,onResend:p.resend,onCallback:p.submit},null,8,["title","onResend","onCallback"]),l(A,{ref:"areacode",onItemclick:p.areaSelect},null,8,["onItemclick"]),l(N,{ref:"alert",ctxt:u.ctxt,ftxt:u.ftxt,onConfirm:p.subResult,title:u.title,content:u.content},null,8,["ctxt","ftxt","onConfirm","title","content"])],64)}],["__scopeId","data-v-d6e557ee"]]);export{N as default};
