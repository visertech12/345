import{bo as e,v as t,t as a,w as s,bp as l,x as i,D as c,E as r,bm as o,A as n,y as u,z as h,u as d,b5 as f,H as p,a as _,l as b,ba as g,b0 as m,aW as y,b2 as v,f as k,q as x,aX as w,B as S,C,F as $,G as T,S as F}from"./index-DJtkXLbk.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as B}from"./uni-app.es.DnKBEGT2.js";import{_ as L}from"./fui-nav-bar.jzMwm7nO.js";import{c as H}from"./currency.DmkscNLR.js";import{e as j}from"./emptyView.DCr5M3Jb.js";import{_ as R,a as V}from"./sc-s.BRuhyDXZ.js";import"./fui-empty.DSVpH_3j.js";const D=I({name:"fui-search-bar",emits:["clear","focus","blur","click","cancel","input","search"],props:{background:{type:String,default:""},paddingTb:{type:[Number,String],default:16},paddingLr:{type:[Number,String],default:24},height:{type:[Number,String],default:72},radius:{type:[Number,String],default:8},color:{type:String,default:""},inputBackground:{type:String,default:"#fff"},focus:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入搜索关键词"},isLeft:{type:Boolean,default:!1},value:{type:String,default:""},disabled:{type:Boolean,default:!1},cancel:{type:Boolean,default:!0},cancelText:{type:String,default:"取消"},cancelColor:{type:String,default:"#7F7F7F"},searchText:{type:String,default:"搜索"},searchColor:{type:String,default:""},showInput:{type:Boolean,default:!0},showLabel:{type:Boolean,default:!0},fixed:{type:Boolean,default:!1}},created(){this.val=this.value,this.plholder=this.placeholder,(this.focus||this.val.length>0)&&(this.isSearch=!0)},mounted(){this.$nextTick((()=>{setTimeout((()=>{this.isFocus=this.focus}),300)}))},watch:{focus(e){this.$nextTick((()=>{setTimeout((()=>{this.isFocus=e}),20)}))},value(e){this.val=e,(this.focus||this.val.length>0)&&(this.isSearch=!0)},placeholder(e){this.plholder=this.placeholder}},computed:{getSearchColor(){return this.searchColor}},data:()=>({isSearch:!1,isFocus:!1,val:"",plholder:""}),methods:{clearInput(){this.val="",this.isFocus=!0,this.$emit("clear")},inputFocus(e){this.showLabel?this.onShowInput():this.isSearch=!0,this.$emit("focus",e)},inputBlur(e){this.isFocus=!1,this.cancel||this.val||(this.isSearch=!1),this.$emit("blur",e)},onShowInput(){!this.disabled&&this.showInput&&(this.isSearch=!0,this.$nextTick((()=>{setTimeout((()=>{this.isFocus=!0}),50)}))),this.$emit("click",{})},hideInput(){this.isSearch=!1,this.isFocus=!1,e(),this.$emit("cancel",{})},inputChange(e){this.val=e.detail.value,this.$emit("input",e)},search(){this.$emit("search",{detail:{value:this.val}})},reset(){this.isSearch=!1,this.isFocus=!1,this.val="",e()}}},[["render",function(e,_,b,g,m,y){const v=d,k=f,x=p;return t(),a(v,{class:r(["fui-search__bar-wrap",{"fui-searchbar__wrap-bg":!b.background}]),style:c({background:b.background,paddingTop:b.paddingTb+"rpx",paddingBottom:b.paddingTb+"rpx",paddingLeft:b.paddingLr+"rpx",paddingRight:b.paddingLr+"rpx"})},{default:s((()=>[l(e.$slots,"default",{},void 0,!0),i(v,{class:"fui-search__bar-form",style:c({height:b.height+"rpx"})},{default:s((()=>[b.showInput?(t(),a(v,{key:0,class:r(["fui-search__bar-box",{"fui-searchbar__focus-invalid":!m.isFocus&&!m.isSearch&&b.showLabel&&!b.disabled}]),style:c({height:b.height+"rpx",borderRadius:b.radius+"rpx",background:b.inputBackground})},{default:s((()=>[i(v,{class:"fui-search__bar-icon"},{default:s((()=>[i(v,{class:"fui-sbi__circle"}),i(v,{class:"fui-sbi__line"})])),_:1}),i(k,{ref:"searchBarRef",class:r(["fui-search__bar-input",{"fui-sb__input-color":!b.color}]),style:c({color:b.color,height:b.height+"rpx"}),"placeholder-class":"fui-search__bar-pl",placeholder:m.plholder,value:m.val,focus:m.isFocus,disabled:b.disabled,"confirm-type":"search",onBlur:y.inputBlur,onFocus:y.inputFocus,onInput:y.inputChange,onConfirm:y.search},null,8,["class","style","placeholder","value","focus","disabled","onBlur","onFocus","onInput","onConfirm"]),m.val.length>0&&!b.disabled?(t(),a(v,{key:0,class:"fui-sbi__clear-wrap",onClick:o(y.clearInput,["stop"])},{default:s((()=>[i(v,{class:"fui-sbi__clear"},{default:s((()=>[i(v,{class:"fui-sbi__clear-a"})])),_:1}),i(v,{class:"fui-sbi__clear"},{default:s((()=>[i(v,{class:"fui-sbi__clear-b"})])),_:1})])),_:1},8,["onClick"])):n("",!0)])),_:1},8,["class","style"])):n("",!0),m.isFocus||m.isSearch||!b.showLabel?n("",!0):(t(),a(v,{key:1,class:r(["fui-search__bar-label",[b.isLeft?"fui-sb__label-left":"fui-sb__label-center"]]),style:c({borderRadius:b.radius+"rpx",background:b.inputBackground}),onClick:y.onShowInput},{default:s((()=>[i(v,{class:"fui-search__bar-icon"},{default:s((()=>[i(v,{class:"fui-sbi__circle"}),i(v,{class:"fui-sbi__line"})])),_:1}),i(x,{class:"fui-search__bar-text"},{default:s((()=>[u(h(b.placeholder),1)])),_:1})])),_:1},8,["class","style","onClick"]))])),_:1},8,["style"]),b.cancel&&m.isSearch&&!m.val&&b.cancelText&&!0!==b.cancelText&&"true"!==b.cancelText?(t(),a(x,{key:0,class:"fui-search__bar-btn",style:c({color:b.cancelColor}),onClick:y.hideInput},{default:s((()=>[u(h(b.cancelText),1)])),_:1},8,["style","onClick"])):n("",!0),m.val&&!b.disabled&&m.isSearch&&b.searchText&&!0!==b.searchText&&"true"!==b.searchText?(t(),a(x,{key:1,class:r(["fui-search__bar-btn",{"fui-sb__btn-color":!b.searchColor}]),style:c({color:y.getSearchColor}),onClick:y.search},{default:s((()=>[u(h(b.searchText),1)])),_:1},8,["class","style","onClick"])):n("",!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-9cf9afcb"]]);var K;const N=I({components:{emptyView:j},computed:{..._(["userTheme"])},data:()=>({value:"",list:[],history:[],scrollHeight:""}),onReady(){this.getMatchesList(),this.history=b("chistory")},watch:{value(e){this.list=K.filter((t=>t.symbol.toLowerCase().includes(e.toLowerCase())))}},methods:{navInit(e){var t=e.height+e.statusBarHeight;this.scrollHeight=this.$device.windowHeight-t},back(){console.log(1),g({animationType:"fade-out",animationDuration:200})},clearHistory(){m("chistory"),this.history=[]},addHistory(e){var t=b("chistory");void 0!==t&&t||(t=[]),(t=t.filter((t=>t.id!=this.list[e].id))).push(this.list[e]),y("chistory",t),this.history=t,this.$mroute.toKline(0,this.list[e].id,1)},toKlines(e){this.$mroute.toKline()},selected(e){if(this.list=this.list.map(((t,a,s)=>(a==e&&(t.select=1),t))),1==this.list[e].is_contract){var t=b("select-contract");t.filter((t=>t.id!=this.list[e].id)),t.push(this.list[e]),y("select-contract",t)}if(1==this.list[e].is_trade){var a=b("select-trade");a.filter((t=>t.id!=this.list[e].id)),a.push(this.list[e]),y("select-trade",a)}y("load",1),v("addSelect"),k({title:this.$t("trade.ts1"),icon:"none"})},deleted(e){var t;if(this.list=this.list.map(((a,s,l)=>(s==e&&(a.select=0,t=a),a))),1==t.is_contract){var a=b("select-contract");a=a.filter((e=>e.id!=t.id)),y("select-contract",a)}if(1==t.is_trade){var s=b("select-trade");s=s.filter((e=>e.id!=t.id)),y("select-trade",s)}y("load",1),v("addSelect"),k({title:this.$t("trade.ts2"),icon:"none"})},async getMatchesList(){var e=await H.matchesCurrency(),t=b("select-trade");void 0!==t&&0!=t.length||(t=[]);var a=b("select-contract");if(void 0!==a&&0!=a.length||(a=[]),200==e.code){for(var s=0;s<e.data.length;s++)e.data=e.data.filter((e=>!this.hideFutures(e.is_futures))),console.log(e.data[s].select),1==e.data[s].is_trade&&t.length>0&&(e.data[s].select=t.filter((t=>t.id==e.data[s].id))),1==e.data[s].is_contract&&a.length>0&&(e.data[s].select=a.filter((t=>t.id==e.data[s].id)));K=e.data,this.list=e.data}},hideFutures:e=>1==e,onSearch(e){this.value=e.detail.value}}},[["render",function(e,l,o,f,_,b){const g=B(x("fui-search-bar"),D),m=d,y=B(x("fui-nav-bar"),L),v=p,k=T,I=w("empty-view"),H=F;return t(),a(m,{class:"searchWrap","data-theme":e.userTheme,platform:e.$platform},{default:s((()=>[i(y,{statusBar:"",padding:0,isFixed:"",isOccupy:"",background:"var(--background-new)",zIndex:"9",custom:"",onInit:b.navInit},{default:s((()=>[i(m,{class:"nav-bar"},{default:s((()=>[i(g,{paddingLr:0,height:68,radius:68,background:"var(--background-new)",inputBackground:"var(--background-secondary)",cancelColor:"var(--content-primary)",searchColor:"var(--color-primary)",color:"var(--content-primary)",placeholder:this.$t("search.please_enter"),modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value=e),focus:!0,searchText:e.$t("wallete.search"),cancelText:e.$t("login.cancel"),onSearch:b.onSearch,onCancel:b.back,onClear:l[1]||(l[1]=e=>_.value="")},null,8,["placeholder","modelValue","searchText","cancelText","onSearch","onCancel"])])),_:1})])),_:1},8,["onInit"]),i(H,{"scroll-y":"true",class:"scroll-view",style:c(`height:${_.scrollHeight}px`)},{default:s((()=>[0!=_.history.length?(t(),a(m,{key:0,class:"historical-search"},{default:s((()=>[i(m,{class:"title-box"},{default:s((()=>[i(v,null,{default:s((()=>[u(h(e.$t("search.history_search")),1)])),_:1}),i(m,{class:"delete-box",onClick:l[2]||(l[2]=e=>b.clearHistory())},{default:s((()=>[i(k,{src:`/static/newImage/delete-${e.userTheme}.png`,mode:"widthFix"},null,8,["src"])])),_:1})])),_:1}),i(m,{class:"tag-group"},{default:s((()=>[(t(!0),S($,null,C(_.history,((l,c)=>(t(),a(m,{class:"item",key:"h"+l.iid,onClick:t=>e.$mroute.toKline(0,l.id,1)},{default:s((()=>[i(v,{class:"font-weight"},{default:s((()=>[u(h(l.symbol),1)])),_:2},1024),i(v,null,{default:s((()=>[u("/ USDT")])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):n("",!0),0!=_.list.length?(t(),S($,{key:1},[i(m,{class:"hot-title"},{default:s((()=>[i(v,null,{default:s((()=>[u(h(e.$t("search.hot_search")),1)])),_:1})])),_:1}),i(m,{class:"hot-list"},{default:s((()=>[(t(!0),S($,null,C(_.list,((l,c)=>(t(),a(m,{key:c,class:"hot-item",onClick:e=>b.addHistory(c)},{default:s((()=>[i(m,{class:"hot-item-left"},{default:s((()=>[i(m,{class:"collect-box"},{default:s((()=>[l.select&&0!=l.select?n("",!0):(t(),a(k,{key:0,src:R,mode:"widthFix",onClick:e=>b.selected(c)},null,8,["onClick"])),l.select&&0!=l.select?(t(),a(k,{key:1,src:V,mode:"widthFix",onClick:e=>b.deleted(c)},null,8,["onClick"])):n("",!0)])),_:2},1024),i(m,{class:"row"},{default:s((()=>[i(v,{class:"font-weight"},{default:s((()=>[u(h(l.symbol),1)])),_:2},1024),i(v,null,{default:s((()=>[u(" / USDT ")])),_:1}),1==l.is_contract?(t(),a(v,{key:0,class:"mini-tag"},{default:s((()=>[u(h(e.$t("tab.contract")),1)])),_:1})):n("",!0),1==l.is_trade?(t(),a(v,{key:1,class:"mini-tag"},{default:s((()=>[u(h(e.$t("index.spot")),1)])),_:1})):n("",!0),1==l.is_futures?(t(),a(v,{key:2,class:"mini-tag"},{default:s((()=>[u(h(e.$t("search.option")),1)])),_:1})):n("",!0)])),_:2},1024)])),_:2},1024),i(m,{class:"hot-item-right"},{default:s((()=>[i(m,{class:"column"},{default:s((()=>[i(v,{class:r(["color-black font-weight",{price_down:l.change_rate<0,price_up:l.change_rate>0}])},{default:s((()=>[u(h(e.$util.thousandSeparator(l.new_price,l.decimals)),1)])),_:2},1032,["class"]),i(v,{class:r(["color-black",{price_down:l.change_rate<0,price_up:l.change_rate>0}])},{default:s((()=>[u(h(l.change_rate?l.change_rate:"--")+"% ",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})],64)):n("",!0),i(I,{visible:0==_.list.length,width:750,height:700,title:e.$t("list.not_data")},null,8,["visible","title"])])),_:1},8,["style"])])),_:1},8,["data-theme","platform"])}],["__scopeId","data-v-15c258b3"]]);export{N as default};
