import{l as e,a as t,b as s,b8 as a,i as o,b9 as r,ba as l,q as n,t as i,w as d,u as c,v as p,x as u,y as m,z as f,H as h,b5 as w}from"./index-DJtkXLbk.js";import{_ as y}from"./fui-icon.Di2eQoC1.js";import{r as b}from"./uni-app.es.DnKBEGT2.js";import{_ as g}from"./fui-nav-bar.jzMwm7nO.js";import{_ as v}from"./fui-button.Bz1nWTaC.js";import{_}from"./alert.Dea_H56C.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-popup-dialog.BcHbARwi.js";import"./uni-popup.CzvQehha.js";var $,x={},T=0,j="";const z=k({data(){return{onFocus:0,password:"",repassword:"",step:0,disable:!1,title:this.$t("login.tip_t2"),content:"",passwordType:[!0,!0]}},onLoad(t){console.log(t),this.containsAtSymbol(t.a)?x.email=t.a:x.phone=t.a,x.vcode=t.c,t.o&&(x.code=t.o);var s=e("invite_code");s&&(x.invite_code=s),t.find&&(T=0!=t.find?1:0,$=t.a),t.type&&(j=t.type)},watch:{password(e){this.step=this.checkPassword(e)}},computed:{...t(["userTheme"])},methods:{...s(["userLogin"]),submit(){if(3!=this.step)return!1;if(this.password!=this.repassword)return this.content=this.$t("setpwd.t10"),this.$refs.alert.open(),!1;if(0==T&&(x.password=this.password,a(),void 0!==x.phone&&x.phone&&o.phoneRegister(x).then((e=>{if(r(),200!=e.code||!e.success)return this.content=e.message,this.$refs.alert.open(),!1;this.userLogin({phone:x.phone,email:"",token:e.data.token,id:e.data.id,nickname:""}),this.$mroute.switchIndex()})),void 0!==x.email&&x.email)){if("google"===j){x.vcode=111111,x.type="google";const t=e("google-info"),s=e("google-token");x.token=s,x.nickname=t.nickName,x.avatar=t.avatarUrl}o.emailRegister(x).then((e=>{if(r(),200!=e.code||!e.success)return this.content=e.message,this.$refs.alert.open(),!1;this.userLogin({phone:"",email:x.email,token:e.data.token,id:e.data.id,nickname:""}),this.$mroute.switchIndex()}))}1==T&&(a(),o.findPwdSet({account:$,code:x.vcode,password:this.password,area:void 0!==x.code?x.code.replace("+","").replace(" ",""):""}).then((e=>{r(),200!=e.code?(this.content=e.message,this.$refs.alert.open()):(this.content=this.$t("setpwd.t11"),this.$refs.alert.open())})))},confirm(){l()},containsAtSymbol:e=>/@/.test(e),checkPassword:e=>/^.{8,14}$/.test(e)?/\d/.test(e)?/[A-Z]/.test(e)?3:2:1:0}},[["render",function(e,t,s,a,o,r){const l=b(n("fui-icon"),y),k=b(n("fui-nav-bar"),g),$=h,x=w,T=c,j=b(n("fui-button"),v),z=b(n("alert"),_);return p(),i(T,{class:"setPassword","data-theme":e.userTheme},{default:d((()=>[u(k,{statusBar:"",isFixed:"",isOccupy:"",zIndex:"9",title:e.$t("setpwd.t1"),color:"var(--content-primary)",background:"var(--background-primary)",onLeftClick:t[0]||(t[0]=t=>e.$mroute.back())},{default:d((()=>[u(l,{name:"arrowleft",size:"56",color:"var(--content-primary)"})])),_:1},8,["title"]),u(T,{class:"setPassword-body"},{default:d((()=>[u(T,{class:"body-label"},{default:d((()=>[u($,{class:"font-13 color-gray"},{default:d((()=>[m(f(e.$t("setpwd.t2")),1)])),_:1}),u(T,{class:"body-label-input mt-10"},{default:d((()=>[u(x,{type:"text",password:o.passwordType[0],modelValue:o.password,"onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e),placeholder:e.$t("setpwd.t3"),"placeholder-class":"placeholder"},null,8,["password","modelValue","placeholder"]),u(l,{onClick:t[2]||(t[2]=e=>o.passwordType[0]=!o.passwordType[0]),name:!0===o.passwordType[0]?"visible":"invisible",size:"38",color:"var(--content-tertiary)"},null,8,["name"])])),_:1})])),_:1}),u(T,{class:"body-label mt-15"},{default:d((()=>[u($,{class:"font-13 color-gray"},{default:d((()=>[m(f(e.$t("setpwd.t4")),1)])),_:1}),u(T,{class:"body-label-input mt-10"},{default:d((()=>[u(x,{type:"text",password:o.passwordType[1],modelValue:o.repassword,"onUpdate:modelValue":t[3]||(t[3]=e=>o.repassword=e),placeholder:e.$t("setpwd.t5"),"placeholder-class":"placeholder"},null,8,["password","modelValue","placeholder"]),u(l,{onClick:t[4]||(t[4]=e=>o.passwordType[1]=!o.passwordType[1]),name:!0===o.passwordType[1]?"visible":"invisible",size:"38",color:"var(--content-tertiary)"},null,8,["name"])])),_:1})])),_:1}),u(T,{class:"body-label mt-15"},{default:d((()=>[u(T,{class:"body-label-tips"},{default:d((()=>[u(T,{class:"flex align-center"},{default:d((()=>[u(l,{name:o.step>=1?"check":"close",size:"34",color:"var(--content-tertiary)"},null,8,["name"]),u($,{class:"font-12 color-gray"},{default:d((()=>[m(f(e.$t("setpwd.t6")),1)])),_:1})])),_:1}),u(T,{class:"flex align-center mt-5"},{default:d((()=>[u(l,{name:o.step>=2?"check":"close",size:"34",color:"var(--content-tertiary)"},null,8,["name"]),u($,{class:"font-12 color-gray"},{default:d((()=>[m(f(e.$t("setpwd.t7")),1)])),_:1})])),_:1}),u(T,{class:"flex align-center mt-5"},{default:d((()=>[u(l,{name:o.step>=3?"check":"close",size:"34",color:"var(--content-tertiary)"},null,8,["name"]),u($,{class:"font-12 color-gray"},{default:d((()=>[m(f(e.$t("setpwd.t8")),1)])),_:1})])),_:1})])),_:1})])),_:1}),u(T,{class:"body-buttons"},{default:d((()=>[u(j,{height:"78rpx",radius:"78rpx",background:3===o.step?"var(--content-primary)":"var(--background-secondary)",size:"26",color:3===o.step?"var(--background-primary)":"var(--content-tertiary)",text:e.$t("setpwd.t9"),onClick:t[5]||(t[5]=e=>r.submit())},null,8,["background","color","text"])])),_:1})])),_:1}),u(z,{ref:"alert",title:o.title,content:o.content,onConfirm:t[6]||(t[6]=e=>r.confirm())},null,8,["title","content"])])),_:1},8,["data-theme"])}],["__scopeId","data-v-c6f6e4ee"]]);export{z as default};
